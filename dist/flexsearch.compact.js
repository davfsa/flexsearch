/**!
 * FlexSearch.js v0.7.0-beta (Compact)
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
(function(self){'use strict';var u;function v(a,b){return"undefined"!==typeof a?a:b}function w(a){const b=Array(a);for(let c=0;c<a;c++)b[c]=y();return b}function y(){return Object.create(null)}function aa(a,b){return b.length-a.length}function A(a){return"string"===typeof a}function B(a){return"object"===typeof a};const ba=/[\u0300-\u036f]/g;function C(a){a.normalize&&(a=a.normalize("NFD").replace(ba,""));return a}function D(a,b){const c=Object.keys(a),e=c.length,d=[];let f="",g=0;for(let h=0,k,l;h<e;h++)k=c[h],(l=a[k])?(d[g++]=E(b?"(?!\\b)"+k+"(\\b|_)":k),d[g++]=l):f+=(f?"|":"")+k;f&&(d[g++]=E(b?"(?!\\b)("+f+")(\\b|_)":"("+f+")"),d[g]="");return d}function F(a,b){for(let c=0,e=b.length;c<e&&(a=a.replace(b[c],b[c+1]),a);c+=2);return a}function E(a){return new RegExp(a,"g")}
function H(a){let b="",c="";for(let e=0,d=a.length,f;e<d;e++)(f=a[e])!==c&&(b+=c=f);return b};const ca=/[\W_]+/;function I(a){return J(this,C(a).toLowerCase(),!1,ca)};const L={},M={};let da=Promise;function ea(a){N(a,"add");N(a,"append");N(a,"search");N(a,"update");N(a,"remove")}function N(a,b){a[b+"Async"]=function(){const c=this,e=arguments;var d=e[e.length-1];let f;"function"===typeof d&&(f=d,delete e[e.length-1]);d=new da(function(g){setTimeout(function(){c.async=!0;const h=c[b].apply(c,e);c.async=!1;g(h)})});return f?(d.then(f),this):d}};function fa(a,b,c,e){var d=a.length;let f=[],g,h=0;e&&(e=[]);for(--d;0<=d;d--){const k=a[d],l=k.length,p=y();let r=!g;for(let q=0;q<l;q++){const t=k[q],m=t.length;if(m)for(let n=0,x=0,z;n<m;n++)if(z=t[n],!g)p[z]=1;else if(g[z]){if(d)e&&x<b&&((e[q]||(e[q]=[]))[x++]=z),p[z]=1;else if(c)c--;else if(f[h++]=z,h===b)return f;r=!0}}if(!r&&!e)return[];g=p}if(e)for(let k=e.length-1,l,p;0<=k;k--)if((p=(l=e[k])&&l.length)&&c&&(p<=c?(c-=p,p=0):p-=c),p){if(h+p>=b)return f.concat(l.slice(c,b-h+c));f=f.concat(c?
l.slice(c):l);h+=p;c=0}return f}function ja(a,b){const c=y(),e=y(),d=[];for(let f=0;f<a.length;f++)c[a[f]]=1;for(let f=0,g;f<b.length;f++){g=b[f];for(let h=0,k;h<g.length;h++)k=g[h],c[k]&&!e[k]&&(e[k]=1,d[d.length]=k)}return d};const ka={memory:{charset:"latin:extra",A:3,o:3,D:!1,s:"memory"},performance:{threshold:8,o:3,context:{depth:1,G:!0}},match:{charset:"latin:extra",H:"full",A:3},score:{charset:"latin:advanced",threshold:1,context:{depth:3,G:!0}},"default":{A:3,threshold:0,depth:3}};M["latin:default"]=I;
function O(a,b){if(!(this instanceof O))return new O(a);var c;let e;a?(A(a)?a=ka[a]:(c=a.preset)&&(a=Object.assign({},c[c],a)),c=a.charset,e=a.lang,A(c)&&(-1===c.indexOf(":")&&(c+=":default"),c=M[c]),A(e)&&(e=L[e])):a={};let d,f,g,h=a.context||{};this.encode=a.encode||c&&c.encode||I;this.register=b||y();d=a.resolution||9;f=a.threshold||0;f>=d&&(f=d-1);this.A=d;this.threshold=f;this.F=b=c&&c.H||a.tokenize||"strict";this.depth="strict"===b&&h.depth;this.G=v(h.bidirectional,!0);this.s=g="memory"===a.optimize;
this.D=v(a.fastupdate,!0);this.o=a.minlength||1;this.h=g?w(d-f):y();d=h.resolution||d;f=h.threshold||f;f>=d&&(f=d-1);this.l=d;this.B=f;this.m=g?w(d-f):y();this.C=c&&c.C||a.rtl;this.I=(b=a.matcher||e&&e.I)&&D(b,!1);this.J=(b=a.stemmer||e&&e.J)&&D(b,!0);if(a=b=a.filter||e&&e.filter){a=b;c=y();for(let k=0,l=a.length;k<l;k++)c[a[k]]=1;a=c}this.filter=a}
function J(a,b,c,e){if(b&&(c&&(b=F(b,c)),a.I&&(b=F(b,a.I)),a.J&&1<b.length&&(b=F(b,a.J)),e||""===e)){b=b.split(e);if(a.filter){a=a.filter;c=b.length;e=[];for(let d=0,f=0;d<c;d++){const g=b[d];g&&!a[g]&&(e[f++]=g)}a=e}else a=b;return a}return b}u=O.prototype;u.append=function(a,b){return this.add(a,b,!0)};
u.add=function(a,b,c,e){if(!e&&!c&&this.register[a])return this.update(a,b);if(b&&(a||0===a)&&(b=this.encode(b),e=b.length)){const p=this.depth,r=this.A-this.threshold,q=y(),t=y();for(let m=0;m<e;m++){let n=b[this.C?e-1-m:m];var d=n.length;if(n&&d>=this.o&&(p||!q[n])){var f=Math.min(this.A/e*m|0,m);if(f<r){var g="";switch(this.F){case "full":if(3<d){for(var h=0;h<d;h++){var k=h?Math.min(f/2+this.A/d*h/2|0,f+h):f;if(k<r)for(var l=d;l>h;l--)g=n.substring(h,l),g.length>=this.o&&R(this,q,g,k,a,c)}break}case "reverse":if(2<
d){for(h=d-1;0<h;h--)g=n[h]+g,g.length>=this.o&&R(this,q,g,f,a,c);g=""}case "forward":if(1<d)for(h=0;h<d;h++)g+=n[h],g.length>=this.o&&R(this,q,g,f,a,c);break;default:if(R(this,q,n,f,a,c),p&&1<e&&m<e-1)for(d=this.l-this.B,f=y(),g=n,h=Math.min(p+1,e-m),f[g]=1,k=1;k<h;k++)if((n=b[this.C?e-1-m-k:m+k])&&n.length>=this.o&&!f[n]){if(f[n]=1,l=Math.min((this.l-h)/e*m+k|0,m+(k-1)),l<d){const x=this.G&&n>g;R(this,t,x?g:n,l,a,c,x?n:g)}}else h=Math.min(h+1,e-m)}}}}this.D||(this.register[a]=1)}return this};
function R(a,b,c,e,d,f,g){let h=g?a.m:a.h;if(!b[c]||g&&!b[c][g])a.s&&(h=h[e]),g?(b=b[c]||(b[c]=y()),b[g]=1,h=h[g]||(h[g]=y())):b[c]=1,h=h[c]||(h[c]=[]),a.s||(h=h[e]||(h[e]=[])),f&&-1!==h.indexOf(d)||(h[h.length]=d,a.D&&(a=a.register[d]||(a.register[d]=[]),a[a.length]=h))}
u.search=function(a,b,c){B(a)?(c=a,a=c.query):B(b)&&(c=b);let e=[],d;var f=this.threshold;let g,h=0;if(c){b=c.limit;h=c.offset||0;f=v(c.threshold,f);var k=c.context;g=c.suggest}if(a&&(a=this.encode(a),d=a.length,1<d)){c=y();var l=[];for(let r=0,q=0,t;r<d;r++)if((t=a[r])&&t.length>=this.o&&!c[t])if(this.s||g||this.h[t])l[q++]=t,c[t]=1;else return e;a=l;d=a.length}if(!d)return e;b||(b=100);c=this.A-f;f=this.l-f;k=this.depth&&1<d&&!1!==k;l=0;let p;k?(p=a[0],l=1):1<d&&a.sort(aa);for(let r,q;l<d;l++){q=
a[l];k?(r=la(this,e,g,f,b,h,2===d,q,p),g&&!1===r&&e.length||(p=q)):r=la(this,e,g,c,b,h,1===d,q);if(r)return r;if(g&&l===d-1){let t=e.length;if(!t){if(k){k=0;l=-1;continue}return e}if(1===t)return ma(e[0],b,h)}}return fa(e,b,h,g)};
function la(a,b,c,e,d,f,g,h,k){let l=[],p=k?a.m:a.h;a.s||(p=na(p,h,k,a.G));if(p){let r=0;e=Math.min(p.length,e);for(let q=0,t=0,m,n;q<e&&!(m=p[q],a.s&&(m=na(m,h,k,a.G)),m&&g&&(n=m.length,n<=f?(f-=n,m=null):f&&(m=m.slice(f),f=0)),m&&(l[r++]=m,g&&(t+=m.length,t>=d)));q++);if(r){if(g)return ma(l,d,0);b[b.length]=l;return}}return!c&&l}function ma(a,b,c){a=1===a.length?a[0]:[].concat.apply([],a);return c||a.length>b?a.slice(c,c+b):a}
function na(a,b,c,e){c?(e=e&&b>c,a=(a=a[e?b:c])&&a[e?c:b]):a=a[b];return a}u.contain=function(a){return!!this.register[a]};u.update=function(a,b){return this.remove(a).add(a,b)};u.remove=function(a,b){const c=this.register[a];if(c){if(this.D)for(let e=0,d;e<c.length;e++)d=c[e],d.splice(d.indexOf(a),1);else S(this.h,a,this.A-this.threshold,this.s),this.depth&&S(this.m,a,this.l-this.B,this.s);b||delete this.register[a]}return this};
function S(a,b,c,e,d){let f=0;if(a.constructor===Array)if(d)b=a.indexOf(b),-1!==b?1<a.length&&(a.splice(b,1),f++):f++;else{d=Math.min(a.length,c);for(let g=0,h;g<d;g++)if(h=a[g])f=S(h,b,c,e,d),e||f||delete a[g]}else for(let g in a)(f=S(a[g],b,c,e,d))||delete a[g];return f}ea(O.prototype);function T(a){if(!(this instanceof T))return new T(a);var b=a.document||a.doc||a,c;this.K=[];this.h=[];this.F=[];this.register=y();this.key=(c=b.key||b.id)&&U(c,this.F)||"id";this.D=v(a.fastupdate,!0);this.B=!!(c=b.extern);this.l=!this.B&&(c=b.store)&&!0!==c&&[];this.store=c&&(this.B?c:y());this.async=!1;c=y();let e=b.index||b.field||b;A(e)&&(e=[e]);for(let d=0,f,g;d<e.length;d++)f=e[d],A(f)||(g=f,f=f.field),g=B(g)?Object.assign({},a,g):a,this.L||(c[f]=new O(g,this.register)),this.K[d]=U(f,this.F),
this.h[d]=f;if(this.l)for(a=b.store,A(a)&&(a=[a]),b=0;b<a.length;b++)this.l[b]=U(a[b],this.F);this.m=c}function U(a,b){const c=a.split(":");let e=0;for(let d=0;d<c.length;d++)a=c[d],0<=a.indexOf("[]")&&(a=a.substring(0,a.length-2))&&(b[e]=!0),a&&(c[e++]=a);e<c.length&&(c.length=e);return 1<e?c:c[0]}function oa(a,b){if(A(b))a=a[b];else for(let c=0;a&&c<b.length;c++)a=a[b[c]];return a}
function V(a,b,c,e,d){a=a[d];if(e===c.length-1)b[d]=a;else if(a)if(a.constructor===Array)for(b=b[d]=Array(a.length),d=0;d<a.length;d++)V(a,b,c,e,d);else b=b[d]||(b[d]=y()),d=c[++e],V(a,b,c,e,d)}function W(a,b,c,e,d,f,g,h){a=a[g];if(e===b.length-1){if(a.constructor===Array){if(c[e]){for(b=0;b<a.length;b++)d.add(f,a[b],!0,!0);return}a=a.join(" ")}d.add(f,a,h,!0)}else if(a)if(a.constructor===Array)for(g=0;g<a.length;g++)W(a,b,c,e,d,f,g,h);else g=b[++e],W(a,b,c,e,d,f,g,h)}u=T.prototype;
u.add=function(a,b,c){B(a)&&(b=a,a=oa(b,this.key));if(b&&(a||0===a)){if(this.register[a])return this.update(a,b);for(let e=0,d,f;e<this.h.length;e++)f=this.h[e],d=this.K[e],A(d)&&(d=[d]),W(b,d,this.F,0,this.m[f],a,d[0],c);if(this.store&&!this.B){let e;if(this.l){e=y();for(let d=0,f;d<this.l.length;d++)f=this.l[d],A(f)?e[f]=b[f]:V(b,e,f,0,f[0])}this.store[a]=e||b}}return this};u.append=function(a,b){return this.add(a,b,!0)};u.update=function(a,b){return this.remove(a).add(a,b)};
u.remove=function(a){B(a)&&(a=oa(a,this.key));if(this.register[a]){const b=this.D&&!this.L;for(let c=0;c<this.h.length&&(this.m[this.h[c]].remove(a,b),!b);c++);this.store&&!this.B&&delete this.store[a];delete this.register[a]}return this};
u.search=function(a,b,c,e){B(a)?(c=a,a=c.query):B(b)&&(c=b,b=0);let d=[],f=[],g,h,k,l,p,r,q=0;if(c)if(c.constructor===Array)k=c,c=null;else{k=(g=c.pluck)||c.index||c.field||c;l=!1;h=this.store&&c.enrich;p="and"===c.bool;b=c.limit||100;r=c.offset||0;if(l&&(A(l)&&(l=[l]),!a)){for(let m=0,n;m<l.length;m++)if(n=pa.call(this,l[m],b,r,h))d[d.length]=n,q++;return q?d:[]}A(k)?k=[k]:k.constructor===Array||(k=null)}k||(k=this.h);p=p&&(1<k.length||l&&1<l.length);const t=!e&&(this.L||this.async)&&[];for(let m=
0,n,x,z;m<k.length;m++){let P;x=k[m];A(x)||(P=x,x=x.field);if(t)t[m]=this.m[x].searchAsync(a,b,P||c);else{e?n=e[m]:n=this.m[x].search(a,b,P||c);z=n&&n.length;if(l&&z){const G=[];let ha=0;p&&(G[0]=[n]);for(let Q=0,ia,K;Q<l.length;Q++)if(ia=l[Q],z=(K=this.M[ia])&&K.length)ha++,G[G.length]=p?[K]:K;ha&&(n=p?fa(G,b||100,r||0):ja(n,G),z=n.length)}if(z)f[q]=x,d[q++]=n;else if(p)return[]}}if(t){const m=this;return new Promise(function(n){Promise.all(t).then(function(x){n(m.search(a,b,c,x))})})}if(!q)return[];
if(g&&(!h||!this.store))return d[0];for(let m=0,n;m<f.length;m++){n=d[m];n.length&&h&&(n=qa.call(this,n));if(g)return n;d[m]={field:f[m],result:n}}return d};function pa(a,b,c,e){let d=this.M[a],f=d&&d.length-c;if(f&&0<f){if(f>b||c)d=d.slice(c,c+b);e&&(d=qa.call(this,d));return{tag:a,result:d}}}function qa(a){const b=Array(a.length);for(let c=0,e;c<a.length;c++)e=a[c],b[c]={key:e,doc:this.store[e]};return b}u.contain=function(a){return!!this.register[a]};u.get=function(a){return this.store[a]};
u.set=function(a,b){this.store[a]=b;return this};ea(T.prototype);const ra=/[\W_]+/,sa=[E("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]"),"a",E("[\u00e8\u00e9\u00ea\u00eb]"),"e",E("[\u00ec\u00ed\u00ee\u00ef]"),"i",E("[\u00f2\u00f3\u00f4\u00f5\u00f6\u0151]"),"o",E("[\u00f9\u00fa\u00fb\u00fc\u0171]"),"u",E("[\u00fd\u0177\u00ff]"),"y",E("\u00f1"),"n",E("[\u00e7c]"),"k",E("\u00df"),"s",E(" & ")," and "];function ta(a){return J(this,C(a).toLowerCase(),!a.normalize&&sa,ra)};var va={encode:ua,C:!1,H:"strict"};const wa=/[^a-z0-9]+/,xa={b:"p",v:"f",w:"f",z:"s",x:"s","\u00df":"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function ua(a){a=ta.call(this,a).join(" ");const b=[];if(a){const c=a.split(wa),e=c.length;for(let d=0,f,g=0;d<e;d++)if((a=c[d])&&(!this.filter||!this.filter[a])){f=a[0];let h=xa[f]||f,k=h;for(let l=1;l<a.length;l++){f=a[l];const p=xa[f]||f;p&&p!==k&&(h+=p,k=p)}b[g++]=h}}return b};var za={encode:ya,C:!1,H:""};const Aa=[E("ae"),"a",E("oe"),"o",E("sh"),"s",E("th"),"t",E("ph"),"f",E("pf"),"f"];function ya(a,b){a&&(a=ua.call(this,a).join(" "),2<a.length&&(a=F(a,Aa)),b||(1<a.length&&(a=H(a)),a&&(a=a.split(" "))));return a};var Ca={encode:Ba,C:!1,H:""};const Da=E("(?!\\b)[aeiouy]");function Ba(a){a&&(a=ya.call(this,a,!0),1<a.length&&(a=a.replace(Da,"")),1<a.length&&(a=H(a)),a&&(a=a.split(" ")));return a};M["latin:simple"]={encode:ta,C:!1,H:""};M["latin:balance"]=va;M["latin:advanced"]=za;M["latin:extra"]=Ca;const X=self;let Y;const Z={Index:O,Document:T,Worker:null,registerCharset:function(a,b){M[a]=b},registerLanguage:function(a,b){L[a]=b}};(Y=X.define)&&Y.amd?Y([],function(){return Z}):X.exports?X.exports=Z:X.FlexSearch=Z;}(this));
