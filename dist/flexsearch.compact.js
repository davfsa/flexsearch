/**!
 * FlexSearch.js v0.7.0-beta (Compact)
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
(function(self){'use strict';var u;function v(a){return"undefined"!==typeof a?a:!0}function w(a){const b=Array(a);for(let c=0;c<a;c++)b[c]=y();return b}function y(){return Object.create(null)}function aa(a,b){return b.length-a.length}function C(a){return"string"===typeof a}function D(a){return"object"===typeof a};const ba=/[\u0300-\u036f]/g;function E(a){a.normalize&&(a=a.normalize("NFD").replace(ba,""));return a}function F(a,b){const c=Object.keys(a),e=c.length,d=[];let f="",g=0;for(let h=0,k,m;h<e;h++)k=c[h],(m=a[k])?(d[g++]=G(b?"(?!\\b)"+k+"(\\b|_)":k),d[g++]=m):f+=(f?"|":"")+k;f&&(d[g++]=G(b?"(?!\\b)("+f+")(\\b|_)":"("+f+")"),d[g]="");return d}function H(a,b){for(let c=0,e=b.length;c<e&&(a=a.replace(b[c],b[c+1]),a);c+=2);return a}function G(a){return new RegExp(a,"g")}
function I(a){let b="",c="";for(let e=0,d=a.length,f;e<d;e++)(f=a[e])!==c&&(b+=c=f);return b};var ca={encode:J,A:!1,B:""};const da=/[\W_]+/;function J(a){return K(this,E(a).toLowerCase(),!1,da)};const ea={},L={};function fa(a){N(a,"add");N(a,"append");N(a,"search");N(a,"update");N(a,"remove")}function N(a,b){a[b+"Async"]=function(){const c=this,e=arguments;var d=e[e.length-1];let f;"function"===typeof d&&(f=d,delete e[e.length-1]);d=new Promise(function(g){setTimeout(function(){c.async=!0;const h=c[b].apply(c,e);c.async=!1;g(h)})});return f?(d.then(f),this):d}};function ha(a,b,c,e){var d=a.length;let f=[],g,h,k=0;e&&(e=[]);for(--d;0<=d;d--){const m=a[d],n=m.length,r=y();let t=!g;for(let q=0;q<n;q++){const l=m[q],p=l.length;if(p)for(let x=0,z,A;x<p;x++)if(A=l[x],g){if(g[A]){if(!d)if(c)c--;else if(f[k++]=A,k===b)return f;if(d||e)r[A]=1;t=!0}if(e&&(h[A]=(z=h[A])?z++:z=1,z<n)){const B=e[z-1]||(e[z-1]=[]);B[B.length]=A}}else r[A]=1}if(e)g||(h=r);else if(!t)return[];g=r}if(e)for(let m=e.length-1,n,r;0<=m;m--){n=e[m];r=n.length;for(let t=0,q;t<r;t++)if(q=n[t],
!g[q]){if(c)c--;else if(f[k++]=q,k===b)return f;g[q]=1}}return f}function ka(a,b){const c=y(),e=y(),d=[];for(let f=0;f<a.length;f++)c[a[f]]=1;for(let f=0,g;f<b.length;f++){g=b[f];for(let h=0,k;h<g.length;h++)k=g[h],c[k]&&!e[k]&&(e[k]=1,d[d.length]=k)}return d};const la={memory:{charset:"latin:extra",D:3,o:3,C:!1,s:"memory"},performance:{threshold:8,o:3,context:{depth:1,F:!0}},match:{charset:"latin:extra",B:"full",D:3},score:{charset:"latin:advanced",threshold:1,context:{depth:3,F:!0}},"default":{D:3,threshold:0,depth:3}};function O(a,b){if(!(this instanceof O))return new O(a);var c;let e;a?(C(a)?a=la[a]:(c=a.preset)&&(a=Object.assign({},c[c],a)),c=a.charset,e=a.lang,C(c)&&(-1===c.indexOf(":")&&(c+=":default"),c=L[c]),C(e)&&(e=ea[e])):a={};let d,f,g=a.context||{};this.encode=a.encode||c&&c.encode||J;this.register=b||y();this.D=d=a.resolution||9;this.B=b=c&&c.B||a.tokenize||"strict";this.depth="strict"===b&&g.depth;this.F=v(g.bidirectional);this.s=f=v(a.optimize);this.C=v(a.fastupdate);this.o=a.minlength||1;this.h=
f?w(d):y();this.m=d=g.resolution||1;this.l=f?w(d):y();this.A=c&&c.A||a.rtl;this.G=(b=a.matcher||e&&e.G)&&F(b,!1);this.H=(b=a.stemmer||e&&e.H)&&F(b,!0);if(a=b=a.filter||e&&e.filter){a=b;c=y();for(let h=0,k=a.length;h<k;h++)c[a[h]]=1;a=c}this.filter=a}function K(a,b,c,e){if(b&&(c&&(b=H(b,c)),a.G&&(b=H(b,a.G)),a.H&&1<b.length&&(b=H(b,a.H)),e||""===e)){b=b.split(e);if(a.filter){a=a.filter;c=b.length;e=[];for(let d=0,f=0;d<c;d++){const g=b[d];g&&!a[g]&&(e[f++]=g)}a=e}else a=b;return a}return b}u=O.prototype;
u.append=function(a,b){return this.add(a,b,!0)};
u.add=function(a,b,c,e){if(!e&&!c&&this.register[a])return this.update(a,b);if(b&&(a||0===a)&&(b=this.encode(b),e=b.length)){const m=this.depth,n=this.D,r=y(),t=y();for(let q=0;q<e;q++){let l=b[this.A?e-1-q:q];var d=l.length;if(l&&d>=this.o&&(m||!r[l])){var f=P(n,e,q),g="";switch(this.B){case "full":if(3<d){for(f=0;f<d;f++)for(var h=d;h>f;h--)if(h-f>=this.o){var k=P(n,e,q,d,f);g=l.substring(f,h);Q(this,r,g,k,a,c)}break}case "reverse":if(2<d){for(h=d-1;0<h;h--)g=l[h]+g,g.length>=this.o&&Q(this,r,g,
P(n,e,q,d,h),a,c);g=""}case "forward":if(1<d)for(h=0;h<d;h++)g+=l[h],g.length>=this.o&&Q(this,r,g,f,a,c);break;default:if(Q(this,r,l,f,a,c),m&&1<e&&q<e-1)for(d=this.m,g=y(),f=l,h=Math.min(m+1,e-q),g[f]=1,k=1;k<h;k++)if((l=b[this.A?e-1-q-k:q+k])&&l.length>=this.o&&!g[l]){g[l]=1;const p=this.F&&l>f;Q(this,t,p?f:l,P(d+(e/2>d?0:1),e,q,h-1,k-1),a,c,p?l:f)}}}}this.C||(this.register[a]=1)}return this};function P(a,b,c,e,d){return c&&1<a?b+(e||0)<=a?c+(d||0):(a-1)/(b+(e||0))*(c+(d||0))+1|0:0}
function Q(a,b,c,e,d,f,g){let h=g?a.l:a.h;if(!b[c]||g&&!b[c][g])a.s&&(h=h[e]),g?(b=b[c]||(b[c]=y()),b[g]=1,h=h[g]||(h[g]=y())):b[c]=1,h=h[c]||(h[c]=[]),a.s||(h=h[e]||(h[e]=[])),f&&-1!==h.indexOf(d)||(h[h.length]=d,a.C&&(a=a.register[d]||(a.register[d]=[]),a[a.length]=h))}
u.search=function(a,b,c){D(a)?(c=a,a=c.query):D(b)&&(c=b);let e=[],d;let f,g=0;if(c){b=c.limit;g=c.offset||0;var h=c.context;f=c.suggest}if(a&&(a=this.encode(a),d=a.length,1<d)){c=y();var k=[];for(let n=0,r=0,t;n<d;n++)if((t=a[n])&&t.length>=this.o&&!c[t])if(this.s||f||this.h[t])k[r++]=t,c[t]=1;else return e;a=k;d=a.length}if(!d)return e;b||(b=100);h=this.depth&&1<d&&!1!==h;c=0;let m;h?(m=a[0],c=1):1<d&&a.sort(aa);for(let n,r;c<d;c++){r=a[c];h?(n=ma(this,e,f,b,g,2===d,r,m),f&&!1===n&&e.length||(m=
r)):n=ma(this,e,f,b,g,1===d,r);if(n)return n;if(f&&c===d-1){k=e.length;if(!k){if(h){h=0;c=-1;continue}return e}if(1===k)return na(e[0],b,g)}}return ha(e,b,g,f)};
function ma(a,b,c,e,d,f,g,h){let k=[],m=h?a.l:a.h;a.s||(m=oa(m,g,h,a.F));if(m){let n=0;const r=Math.min(m.length,h?a.m:a.D);for(let t=0,q=0,l,p;t<r;t++)if(l=m[t])if(a.s&&(l=oa(l,g,h,a.F)),d&&l&&f&&(p=l.length,p<=d?(d-=p,l=null):(l=l.slice(d),d=0)),l&&(k[n++]=l,f&&(q+=l.length,q>=e)))break;if(n){if(f)return na(k,e,0);b[b.length]=k;return}}return!c&&k}function na(a,b,c){a=1===a.length?a[0]:[].concat.apply([],a);return c||a.length>b?a.slice(c,c+b):a}
function oa(a,b,c,e){c?(e=e&&b>c,a=(a=a[e?b:c])&&a[e?c:b]):a=a[b];return a}u.contain=function(a){return!!this.register[a]};u.update=function(a,b){return this.remove(a).add(a,b)};u.remove=function(a,b){const c=this.register[a];if(c){if(this.C)for(let e=0,d;e<c.length;e++)d=c[e],d.splice(d.indexOf(a),1);else S(this.h,a,this.D,this.s),this.depth&&S(this.l,a,this.m,this.s);b||delete this.register[a]}return this};
function S(a,b,c,e,d){let f=0;if(a.constructor===Array)if(d)b=a.indexOf(b),-1!==b?1<a.length&&(a.splice(b,1),f++):f++;else{d=Math.min(a.length,c);for(let g=0,h;g<d;g++)if(h=a[g])f=S(h,b,c,e,d),e||f||delete a[g]}else for(let g in a)(f=S(a[g],b,c,e,d))||delete a[g];return f}fa(O.prototype);function T(a){if(!(this instanceof T))return new T(a);var b=a.document||a.doc||a,c;this.I=[];this.h=[];this.m=[];this.register=y();this.key=(c=b.key||b.id)&&U(c,this.m)||"id";this.C=v(a.fastupdate);this.l=(c=b.store)&&!0!==c&&[];this.store=c&&y();this.async=!1;c=y();let e=b.index||b.field||b;C(e)&&(e=[e]);for(let d=0,f,g;d<e.length;d++)f=e[d],C(f)||(g=f,f=f.field),g=D(g)?Object.assign({},a,g):a,this.J||(c[f]=new O(g,this.register)),this.I[d]=U(f,this.m),this.h[d]=f;if(this.l)for(a=b.store,C(a)&&(a=
[a]),b=0;b<a.length;b++)this.l[b]=U(a[b],this.m);this.index=c}function U(a,b){const c=a.split(":");let e=0;for(let d=0;d<c.length;d++)a=c[d],0<=a.indexOf("[]")&&(a=a.substring(0,a.length-2))&&(b[e]=!0),a&&(c[e++]=a);e<c.length&&(c.length=e);return 1<e?c:c[0]}function pa(a,b){if(C(b))a=a[b];else for(let c=0;a&&c<b.length;c++)a=a[b[c]];return a}
function V(a,b,c,e,d){a=a[d];if(e===c.length-1)b[d]=a;else if(a)if(a.constructor===Array)for(b=b[d]=Array(a.length),d=0;d<a.length;d++)V(a,b,c,e,d);else b=b[d]||(b[d]=y()),d=c[++e],V(a,b,c,e,d)}function W(a,b,c,e,d,f,g,h){a=a[g];if(e===b.length-1){if(a.constructor===Array){if(c[e]){for(b=0;b<a.length;b++)d.add(f,a[b],!0,!0);return}a=a.join(" ")}d.add(f,a,h,!0)}else if(a)if(a.constructor===Array)for(g=0;g<a.length;g++)W(a,b,c,e,d,f,g,h);else g=b[++e],W(a,b,c,e,d,f,g,h)}u=T.prototype;
u.add=function(a,b,c){D(a)&&(b=a,a=pa(b,this.key));if(b&&(a||0===a)){if(this.register[a])return this.update(a,b);for(let e=0,d,f;e<this.h.length;e++)f=this.h[e],d=this.I[e],C(d)&&(d=[d]),W(b,d,this.m,0,this.index[f],a,d[0],c);if(this.store){let e;if(this.l){e=y();for(let d=0,f;d<this.l.length;d++)f=this.l[d],C(f)?e[f]=b[f]:V(b,e,f,0,f[0])}this.store[a]=e||b}}return this};u.append=function(a,b){return this.add(a,b,!0)};u.update=function(a,b){return this.remove(a).add(a,b)};
u.remove=function(a){D(a)&&(a=pa(a,this.key));if(this.register[a]){const b=this.C&&!this.J;for(let c=0;c<this.h.length&&(this.index[this.h[c]].remove(a,b),!b);c++);this.store&&delete this.store[a];delete this.register[a]}return this};
u.search=function(a,b,c,e){D(a)?(c=a,a=c.query):D(b)&&(c=b,b=0);let d=[],f=[],g,h,k,m,n,r,t=0;if(c)if(c.constructor===Array)k=c,c=null;else{k=(g=c.pluck)||c.index||c.field||c;m=!1;h=this.store&&c.enrich;n="and"===c.bool;b=c.limit||100;r=c.offset||0;if(m&&(C(m)&&(m=[m]),!a)){for(let l=0,p;l<m.length;l++)if(p=qa.call(this,m[l],b,r,h))d[d.length]=p,t++;return t?d:[]}C(k)?k=[k]:k.constructor===Array||(k=null)}k||(k=this.h);n=n&&(1<k.length||m&&1<m.length);const q=!e&&(this.J||this.async)&&[];for(let l=
0,p,x,z;l<k.length;l++){let A;x=k[l];C(x)||(A=x,x=x.field);if(q)q[l]=this.index[x].searchAsync(a,b,A||c);else{e?p=e[l]:p=this.index[x].search(a,b,A||c);z=p&&p.length;if(m&&z){const B=[];let ia=0;n&&(B[0]=[p]);for(let R=0,ja,M;R<m.length;R++)if(ja=m[R],z=(M=this.K[ja])&&M.length)ia++,B[B.length]=n?[M]:M;ia&&(p=n?ha(B,b||100,r||0):ka(p,B),z=p.length)}if(z)f[t]=x,d[t++]=p;else if(n)return[]}}if(q){const l=this;return new Promise(function(p){Promise.all(q).then(function(x){p(l.search(a,b,c,x))})})}if(!t)return[];
if(g&&(!h||!this.store))return d[0];for(let l=0,p;l<f.length;l++){p=d[l];p.length&&h&&(p=ra.call(this,p));if(g)return p;d[l]={field:f[l],result:p}}return d};function qa(a,b,c,e){let d=this.K[a],f=d&&d.length-c;if(f&&0<f){if(f>b||c)d=d.slice(c,c+b);e&&(d=ra.call(this,d));return{tag:a,result:d}}}function ra(a){const b=Array(a.length);for(let c=0,e;c<a.length;c++)e=a[c],b[c]={key:e,doc:this.store[e]};return b}u.contain=function(a){return!!this.register[a]};u.get=function(a){return this.store[a]};
u.set=function(a,b){this.store[a]=b;return this};fa(T.prototype);var ta={encode:sa,A:!1,B:""};const ua=/[\W_]+/,va=[G("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]"),"a",G("[\u00e8\u00e9\u00ea\u00eb]"),"e",G("[\u00ec\u00ed\u00ee\u00ef]"),"i",G("[\u00f2\u00f3\u00f4\u00f5\u00f6\u0151]"),"o",G("[\u00f9\u00fa\u00fb\u00fc\u0171]"),"u",G("[\u00fd\u0177\u00ff]"),"y",G("\u00f1"),"n",G("[\u00e7c]"),"k",G("\u00df"),"s",G(" & ")," and "];function sa(a){return K(this,E(a).toLowerCase(),!a.normalize&&va,ua)};var xa={encode:wa,A:!1,B:"strict"};const ya=/[^a-z0-9]+/,za={b:"p",v:"f",w:"f",z:"s",x:"s","\u00df":"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function wa(a){a=sa.call(this,a).join(" ");const b=[];if(a){const c=a.split(ya),e=c.length;for(let d=0,f,g=0;d<e;d++)if((a=c[d])&&(!this.filter||!this.filter[a])){f=a[0];let h=za[f]||f,k=h;for(let m=1;m<a.length;m++){f=a[m];const n=za[f]||f;n&&n!==k&&(h+=n,k=n)}b[g++]=h}}return b};var Ba={encode:Aa,A:!1,B:""};const Ca=[G("ae"),"a",G("oe"),"o",G("sh"),"s",G("th"),"t",G("ph"),"f",G("pf"),"f"];function Aa(a,b){a&&(a=wa.call(this,a).join(" "),2<a.length&&(a=H(a,Ca)),b||(1<a.length&&(a=I(a)),a&&(a=a.split(" "))));return a};var Ea={encode:Da,A:!1,B:""};const Fa=G("(?!\\b)[aeiouy]");function Da(a){a&&(a=Aa.call(this,a,!0),1<a.length&&(a=a.replace(Fa,"")),1<a.length&&(a=I(a)),a&&(a=a.split(" ")));return a};L["latin:default"]=ca;L["latin:simple"]=ta;L["latin:balance"]=xa;L["latin:advanced"]=Ba;L["latin:extra"]=Ea;const X=self;let Y;const Z={Index:O,Document:T,Worker:null,registerCharset:function(a,b){L[a]=b},registerLanguage:function(a,b){ea[a]=b}};(Y=X.define)&&Y.amd?Y([],function(){return Z}):X.exports?X.exports=Z:X.FlexSearch=Z;}(this));
