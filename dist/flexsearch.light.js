/**!
 * FlexSearch.js v0.7.0-beta (Light)
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
(function(self){'use strict';function u(a){return"undefined"!==typeof a?a:!0}function w(a){const c=Array(a);for(let b=0;b<a;b++)c[b]=z();return c}function z(){return Object.create(null)}function A(a,c){return c.length-a.length};const B=/[\u0300-\u036f]/g;function C(a,c){const b=Object.keys(a),d=b.length,e=[];let h="",g=0;for(let f=0,l,p;f<d;f++)l=b[f],(p=a[l])?(e[g++]=new RegExp(c?"(?!\\b)"+l+"(\\b|_)":l,"g"),e[g++]=p):h+=(h?"|":"")+l;h&&(e[g++]=new RegExp(c?"(?!\\b)("+h+")(\\b|_)":"("+h+")","g"),e[g]="");return e}function D(a,c){for(let b=0,d=c.length;b<d&&(a=a.replace(c[b],c[b+1]),a);b+=2);return a};const F=/[\W_]+/;function G(a){a.normalize&&(a=a.normalize("NFD").replace(B,""));if(a=a.toLowerCase())if(this.o&&(a=D(a,this.o)),this.A&&1<a.length&&(a=D(a,this.A)),F||""===F)if(a=a.split(F),this.filter){var c=this.filter;const b=a.length,d=[];for(let e=0,h=0;e<b;e++){const g=a[e];g&&!c[g]&&(d[h++]=g)}a=d}return a};const H={},I={};function J(a,c,b,d){const e=a.length;let h=[],g;let f,l;for(var p=0;p<e;p++){var m=a[p],q=m.length,r=0;for(let k=0,t;k<q;k++)(t=m[k])&&(r+=t.length);if(!n||r<n){var n=r;f=m;l=p}}f=1===f.length?f[0]:[].concat.apply([],f);d&&(d=[f],g=z());p=n=0;for(m=e-1;0<=m;m--)if(m!==l){p++;q=a[m];r=q.length;const k=[];let t=0;for(let y=0,v;y<f.length;y++){v=f[y];let x;for(let E=0;E<r;E++){const M=q[E];if(M.length&&(x=-1!==M.indexOf(v))){if(p===e-1){if(b)b--;else if(h[n++]=v,n===c)return h;d&&(g[v]=1)}break}}x&&
(k[t++]=v)}if(d)d[p]=k;else if(!t)return[];f=k}if(d)for(let k=d.length-1,t,y;0<=k;k--)if(y=(t=d[k])&&t.length)for(let v=0,x;v<y;v++)if(x=t[v],!g[x])if(g[x]=1,b)b--;else if(h[n++]=x,n===c)return h;return h};function K(a,c){if(!(this instanceof K))return new K(a);let b;if(a){var d=a.charset;b=a.lang;"string"===typeof d&&(-1===d.indexOf(":")&&(d+=":default"),d=I[d]);"string"===typeof b&&(b=H[b])}else a={};let e,h,g=a.context||{};this.encode=a.encode||d&&d.encode||G;this.register=c||z();this.v=e=a.resolution||9;this.C=c=d&&d.C||a.tokenize||"strict";this.j="strict"===c&&g.depth;this.l=u(g.bidirectional);this.g=h=u(a.optimize);this.s=u(a.fastupdate);this.h=a.minlength||1;this.i=h?w(e):z();this.B=e=g.resolution||
1;this.m=h?w(e):z();this.u=d&&d.u||a.rtl;this.o=(c=a.matcher||b&&b.o)&&C(c,!1);this.A=(c=a.stemmer||b&&b.A)&&C(c,!0);if(a=c=a.filter||b&&b.filter){a=c;d=z();for(let f=0,l=a.length;f<l;f++)d[a[f]]=1;a=d}this.filter=a}K.prototype.append=function(a,c){return this.add(a,c,!0)};
K.prototype.add=function(a,c,b,d){if(!d&&!b&&this.register[a])return this.update(a,c);if(c&&(a||0===a)&&(c=this.encode(c),d=c.length)){const p=this.j,m=this.v,q=z(),r=z();for(let n=0;n<d;n++){let k=c[this.u?d-1-n:n];var e=k.length;if(k&&e>=this.h&&(p||!q[k])){var h=d<m?n:m/d*n|0,g="";switch(this.C){case "full":if(3<e){for(h=0;h<e;h++)for(var f=e;f>h;f--)if(f-h>=this.h){var l=d+e<m?n+h:m/(d+e)*(n+h)|0;g=k.substring(h,f);L(this,q,g,l,a,b)}break}case "reverse":if(2<e){for(f=e-1;0<f;f--)g=k[f]+g,g.length>=
this.h&&L(this,q,g,d+e<m?n+f:m/(d+e)*(n+f)|0,a,b);g=""}case "forward":if(1<e)for(f=0;f<e;f++)g+=k[f],g.length>=this.h&&L(this,q,g,h,a,b);break;default:if(L(this,q,k,h,a,b),p&&1<d&&n<d-1)for(e=this.B,g=z(),h=k,f=Math.min(p+1,d-n),g[h]=1,l=1;l<f;l++)if((k=c[this.u?d-1-n-l:n+l])&&k.length>=this.h&&!g[k]){g[k]=1;const t=this.l&&k>h;L(this,r,t?h:k,f+d<e?n+(l-1):e/(f+d)*(n+l)|0,a,b,t?k:h)}}}}this.s||(this.register[a]=1)}return this};
function L(a,c,b,d,e,h,g){let f=g?a.m:a.i;if(!c[b]||g&&!c[b][g])a.g&&(f=f[d]),g?(c=c[b]||(c[b]=z()),c[g]=1,f=f[g]||(f[g]=z())):c[b]=1,f=f[b]||(f[b]=[]),a.g||(f=f[d]||(f[d]=[])),h&&-1!==f.indexOf(e)||(f[f.length]=e,a.s&&(a=a.register[e]||(a.register[e]=[]),a[a.length]=f))}
K.prototype.search=function(a,c,b){"object"===typeof a?(b=a,a=b.query):"object"===typeof c&&(b=c);let d=[],e;let h,g=0;if(b){c=b.limit;g=b.offset||0;var f=b.context;h=!1}if(a&&(a=this.encode(a),e=a.length,1<e)){b=z();var l=[];for(let m=0,q=0,r;m<e;m++)if((r=a[m])&&r.length>=this.h&&!b[r])if(this.g||h||this.i[r])l[q++]=r,b[r]=1;else return d;a=l;e=a.length}if(!e)return d;c||(c=100);f=this.j&&1<e&&!1!==f;b=0;let p;f?(p=a[0],b=1):1<e&&a.sort(A);for(let m,q;b<e;b++){q=a[b];f?(m=N(this,d,h,c,g,2===e,q,
p),h&&!1===m&&d.length||(p=q)):m=N(this,d,h,c,g,1===e,q);if(m)return m;if(h&&b===e-1){l=d.length;if(!l){if(f){f=0;b=-1;continue}return d}if(1===l)return O(d[0],c,g)}}return J(d,c,g,h)};
function N(a,c,b,d,e,h,g,f){let l=[],p=f?a.m:a.i;a.g||(p=P(p,g,f,a.l));if(p){let m=0;const q=Math.min(p.length,f?a.B:a.v);for(let r=0,n=0,k,t;r<q;r++)if(k=p[r])if(a.g&&(k=P(k,g,f,a.l)),e&&k&&h&&(t=k.length,t<=e?(e-=t,k=null):(k=k.slice(e),e=0)),k&&(l[m++]=k,h&&(n+=k.length,n>=d)))break;if(m){if(h)return O(l,d,0);c[c.length]=l;return}}return!b&&l}function O(a,c,b){a=1===a.length?a[0]:[].concat.apply([],a);return b||a.length>c?a.slice(b,b+c):a}
function P(a,c,b,d){b?(d=d&&c>b,a=(a=a[d?c:b])&&a[d?b:c]):a=a[c];return a}K.prototype.contain=function(a){return!!this.register[a]};K.prototype.update=function(a,c){return this.remove(a).add(a,c)};K.prototype.remove=function(a,c){const b=this.register[a];if(b){if(this.s)for(let d=0,e;d<b.length;d++)e=b[d],e.splice(e.indexOf(a),1);else Q(this.i,a,this.v,this.g),this.j&&Q(this.m,a,this.B,this.g);c||delete this.register[a]}return this};
function Q(a,c,b,d,e){let h=0;if(a.constructor===Array)if(e)c=a.indexOf(c),-1!==c?1<a.length&&(a.splice(c,1),h++):h++;else{e=Math.min(a.length,b);for(let g=0,f;g<e;g++)if(f=a[g])h=Q(f,c,b,d,e),d||h||delete a[g]}else for(let g in a)(h=Q(a[g],c,b,d,e))||delete a[g];return h};const R=self;let S;const T={Index:K,Document:null,Worker:null,registerCharset:function(a,c){I[a]=c},registerLanguage:function(a,c){H[a]=c}};(S=R.define)&&S.amd?S([],function(){return T}):R.exports?R.exports=T:R.FlexSearch=T;}(this));
