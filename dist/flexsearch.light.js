/**!
 * FlexSearch.js v0.7.0-beta (Light)
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
(function(self){'use strict';function u(a){return"undefined"!==typeof a?a:!0}function w(a){const c=Array(a);for(let b=0;b<a;b++)c[b]=z();return c}function z(){return Object.create(null)}function A(a,c){return c.length-a.length};const B=/[\u0300-\u036f]/g;function C(a,c){const b=Object.keys(a),d=b.length,f=[];let h="",g=0;for(let e=0,l,m;e<d;e++)l=b[e],(m=a[l])?(f[g++]=new RegExp(c?"(?!\\b)"+l+"(\\b|_)":l,"g"),f[g++]=m):h+=(h?"|":"")+l;h&&(f[g++]=new RegExp(c?"(?!\\b)("+h+")(\\b|_)":"("+h+")","g"),f[g]="");return f}function D(a,c){for(let b=0,d=c.length;b<d&&(a=a.replace(c[b],c[b+1]),a);b+=2);return a};const F=/[\W_]+/;function G(a){a.normalize&&(a=a.normalize("NFD").replace(B,""));if(a=a.toLowerCase())if(this.o&&(a=D(a,this.o)),this.A&&1<a.length&&(a=D(a,this.A)),F||""===F)if(a=a.split(F),this.filter){var c=this.filter;const b=a.length,d=[];for(let f=0,h=0;f<b;f++){const g=a[f];g&&!c[g]&&(d[h++]=g)}a=d}return a};const H={},I={};function J(a,c,b,d){const f=a.length;let h=[],g;let e,l;for(var m=0;m<f;m++){var n=a[m],q=n.length,r=0;for(let k=0,t;k<q;k++)(t=n[k])&&(r+=t.length);if(!p||r<p){var p=r;e=n;l=m}}e=1===e.length?e[0]:[].concat.apply([],e);d&&(d=[e],g=z());m=p=0;for(n=f-1;0<=n;n--)if(n!==l){m++;q=a[n];r=q.length;const k=[];let t=0;for(let y=0,v;y<e.length;y++){v=e[y];let x;for(let E=0;E<r;E++){const N=q[E];if(N.length&&(x=-1!==N.indexOf(v))){if(m===f-1){if(b)b--;else if(h[p++]=v,p===c)return h;d&&(g[v]=1)}break}}x&&
(k[t++]=v)}if(d)d[m]=k;else if(!t)return[];e=k}if(d)for(let k=d.length-1,t,y;0<=k;k--)if(y=(t=d[k])&&t.length)for(let v=0,x;v<y;v++)if(x=t[v],!g[x])if(g[x]=1,b)b--;else if(h[p++]=x,p===c)return h;return h};I["latin:default"]=G;
function K(a,c){if(!(this instanceof K))return new K(a);let b;if(a){var d=a.charset;b=a.lang;"string"===typeof d&&(-1===d.indexOf(":")&&(d+=":default"),d=I[d]);"string"===typeof b&&(b=H[b])}else a={};let f,h,g=a.context||{};this.encode=a.encode||d&&d.encode||G;this.register=c||z();this.v=f=a.resolution||9;this.C=c=d&&d.D||a.tokenize||"strict";this.j="strict"===c&&g.depth;this.l=u(g.bidirectional);this.g=h="memory"===a.optimize;this.s=u(a.fastupdate);this.h=a.minlength||1;this.i=h?w(f):z();this.B=
f=g.resolution||1;this.m=h?w(f):z();this.u=d&&d.u||a.rtl;this.o=(c=a.matcher||b&&b.o)&&C(c,!1);this.A=(c=a.stemmer||b&&b.A)&&C(c,!0);if(a=c=a.filter||b&&b.filter){a=c;d=z();for(let e=0,l=a.length;e<l;e++)d[a[e]]=1;a=d}this.filter=a}K.prototype.append=function(a,c){return this.add(a,c,!0)};
K.prototype.add=function(a,c,b,d){if(!d&&!b&&this.register[a])return this.update(a,c);if(c&&(a||0===a)&&(c=this.encode(c),d=c.length)){const m=this.j,n=this.v,q=z(),r=z();for(let p=0;p<d;p++){let k=c[this.u?d-1-p:p];var f=k.length;if(k&&f>=this.h&&(m||!q[k])){var h=Math.min(n/d*p|0,p),g="";switch(this.C){case "full":if(3<f){for(var e=0;e<f;e++){var l=e?Math.min(h/2+n/f*e/2|0,h+e):h;for(let t=f;t>e;t--)g=k.substring(e,t),g.length>=this.h&&L(this,q,g,l,a,b)}break}case "reverse":if(2<f){for(e=f-1;0<
e;e--)g=k[e]+g,g.length>=this.h&&L(this,q,g,h,a,b);g=""}case "forward":if(1<f)for(e=0;e<f;e++)g+=k[e],g.length>=this.h&&L(this,q,g,h,a,b);break;default:if(L(this,q,k,h,a,b),m&&1<d&&p<d-1)for(f=z(),h=k,g=Math.min(m+1,d-p),f[h]=1,e=1;e<g;e++)(k=c[this.u?d-1-p-e:p+e])&&k.length>=this.h&&!f[k]?(f[k]=1,l=this.l&&k>h,L(this,r,l?h:k,0,a,b,l?k:h)):g=Math.min(g+1,d-p)}}}this.s||(this.register[a]=1)}return this};
function L(a,c,b,d,f,h,g){let e=g?a.m:a.i;if(!c[b]||g&&!c[b][g])a.g&&(e=e[d]),g?(c=c[b]||(c[b]=z()),c[g]=1,e=e[g]||(e[g]=z())):c[b]=1,e=e[b]||(e[b]=[]),a.g||(e=e[d]||(e[d]=[])),h&&-1!==e.indexOf(f)||(e[e.length]=f,a.s&&(a=a.register[f]||(a.register[f]=[]),a[a.length]=e))}
K.prototype.search=function(a,c,b){"object"===typeof a?(b=a,a=b.query):"object"===typeof c&&(b=c);let d=[],f;let h,g=0;if(b){c=b.limit;g=b.offset||0;var e=b.context;h=!1}if(a&&(a=this.encode(a),f=a.length,1<f)){b=z();var l=[];for(let n=0,q=0,r;n<f;n++)if((r=a[n])&&r.length>=this.h&&!b[r])if(this.g||h||this.i[r])l[q++]=r,b[r]=1;else return d;a=l;f=a.length}if(!f)return d;c||(c=100);e=this.j&&1<f&&!1!==e;b=0;let m;e?(m=a[0],b=1):1<f&&a.sort(A);for(let n,q;b<f;b++){q=a[b];e?(n=M(this,d,h,c,g,2===f,q,
m),h&&!1===n&&d.length||(m=q)):n=M(this,d,h,c,g,1===f,q);if(n)return n;if(h&&b===f-1){l=d.length;if(!l){if(e){e=0;b=-1;continue}return d}if(1===l)return O(d[0],c,g)}}return J(d,c,g,h)};
function M(a,c,b,d,f,h,g,e){let l=[],m=e?a.m:a.i;a.g||(m=P(m,g,e,a.l));if(m){let n=0;const q=Math.min(m.length,e?a.B:a.v);for(let r=0,p=0,k,t;r<q;r++)if(k=m[r])if(a.g&&(k=P(k,g,e,a.l)),f&&k&&h&&(t=k.length,t<=f?(f-=t,k=null):(k=k.slice(f),f=0)),k&&(l[n++]=k,h&&(p+=k.length,p>=d)))break;if(n){if(h)return O(l,d,0);c[c.length]=l;return}}return!b&&l}function O(a,c,b){a=1===a.length?a[0]:[].concat.apply([],a);return b||a.length>c?a.slice(b,b+c):a}
function P(a,c,b,d){b?(d=d&&c>b,a=(a=a[d?c:b])&&a[d?b:c]):a=a[c];return a}K.prototype.contain=function(a){return!!this.register[a]};K.prototype.update=function(a,c){return this.remove(a).add(a,c)};K.prototype.remove=function(a,c){const b=this.register[a];if(b){if(this.s)for(let d=0,f;d<b.length;d++)f=b[d],f.splice(f.indexOf(a),1);else Q(this.i,a,this.v,this.g),this.j&&Q(this.m,a,this.B,this.g);c||delete this.register[a]}return this};
function Q(a,c,b,d,f){let h=0;if(a.constructor===Array)if(f)c=a.indexOf(c),-1!==c?1<a.length&&(a.splice(c,1),h++):h++;else{f=Math.min(a.length,b);for(let g=0,e;g<f;g++)if(e=a[g])h=Q(e,c,b,d,f),d||h||delete a[g]}else for(let g in a)(h=Q(a[g],c,b,d,f))||delete a[g];return h};const R=self;let S;const T={Index:K,Document:null,Worker:null,registerCharset:function(a,c){I[a]=c},registerLanguage:function(a,c){H[a]=c}};(S=R.define)&&S.amd?S([],function(){return T}):R.exports?R.exports=T:R.FlexSearch=T;}(this));
